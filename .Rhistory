ggplot(data = dt.master,aes(x = records_breached)) + geom_boxplot()
num_records<-dt.master$records_breached[which(dt.master$records_breached!= NaN)]
head(num_rcords)
head(num_records)
num_records<-as.dataframe(dt.master$records_breached[which(dt.master$records_breached!= NaN)])
num_records<-as.DataFrame(dt.master$records_breached[which(dt.master$records_breached!= NaN)])
num_records<-Dataframe(dt.master$records_breached[which(dt.master$records_breached!= NaN)])
num_records<-as.data.frame(dt.master$records_breached[which(dt.master$records_breached!= NaN)])
head(num_records)
table(dt.master$records_breached)
num_records<-as.data.frame(dt.master$records_breached)
head(num_records)
num_records<-num_records[!is.na(num_records)]
ggplot(data = dt.master,aes(x = records_breached)) + geom_boxplot()
num_records<-as.data.frame(dt.master$records_breached[!is.na(dt.master$records_breached)])
ggplot(data = dt.master,aes(x = records_breached)) + geom_boxplot()
str(dt.master)
dt.master$records_breached<-as.data.frame(dt.master$records_breached[!is.na(dt.master$records_breached)])
ggplot(data = dt.master,aes(x = cat_name, y =records_breached )) + geom_boxplot()
ggplot(data = dt.master,aes(x = cat_name, y =records_breached )) + geom_boxplot() + coord_flip()
dt.master$records_breached<-as.data.frame(dt.master$records_breached[!is.na(dt.master$records_breached) & dt.master&records_breached < 1000000])
dt.master$records_breached<-as.data.frame(dt.master$records_breached[!is.na(dt.master$records_breached) && dt.master&records_breached < 1000000])
dt.master$records_breached<-as.data.frame(dt.master$records_breached[!is.na(dt.master$records_breached) & dt.master&records_breached < 1000000])
class(dt.master$records)
dt.master$records_breached<-as.data.frame(dt.master$records_breached[!is.na(dt.master$records_breached) & dt.master&records_breached < 20000])
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
parent_dir <- getwd()
dt.categories <- fread(glue("{parent_dir}/health_care_data/categories.csv"))
dt.catorgs <- fread(glue("{parent_dir}/health_care_data/catsorgs.csv"))
dt.orgsindex <- fread(glue("{parent_dir}/health_care_data/orgsindex.csv"))
dt.prcbreaches <- fread(glue("{parent_dir}/health_care_data/prcbreaches2005-18.csv"))
dt.categories_final <- dt.categories[,list(cat_id = CatID,
cat_name = CatName)]
dt.catorgs_final <- dt.catorgs[,list(cat_id = CatID,
org_id = OrgID,
type = Type)]
dt.orgsindex_final <- dt.orgsindex[,list(org_id = OrgID,
company_name = Name,
source_type = SourceType)]
dt.prcbreaches_final <- dt.prcbreaches[,list(records_breached = Records.Breached,
records_breached_detail = Records.Breached...Detail,
name = Name,
cat_id = CatID,
total_records = Total.Records,
region = Region,
category = Category_dm,
entity_type = Entity_prc,
state = State,
org_id = OrgID,
location = Location,
dt = Date.Made.Public,
breach_source = Source.of.Breach.Notification,
breach_type = Type)]
dt.orgsindex_final <- unique(dt.orgsindex_final, by = c("org_id"))
dt.master <- merge(merge(merge(dt.prcbreaches_final, dt.catorgs_final, by = c("cat_id", "org_id"), all.x = TRUE),
dt.categories_final, by = c("cat_id"), all.x = TRUE),
dt.orgsindex_final, by = c("org_id"), all.x = TRUE)
dt.master
cat_records_breached <- dt.master %>% filter(records_breached <20000 & !is.na(records_breached)) %>% select(records_breached, cat_name)
head(cat_records_breached)
ggplot(data = cat_records_breached,aes(x = cat_name, y =records_breached )) + geom_boxplot() + coord_flip()
cat_records_breached <- dt.master %>% filter(records_breached <20000000& !is.na(records_breached)) %>% select(records_breached, cat_name)
ggplot(data = cat_records_breached,aes(x = cat_name, y =records_breached )) + geom_boxplot() + coord_flip()
cat_records_breached <- dt.master %>% filter(records_breached <10000000& !is.na(records_breached)) %>% select(records_breached, cat_name)
ggplot(data = cat_records_breached,aes(x = cat_name, y =records_breached )) + geom_boxplot() + coord_flip()
cat_records_breached <- dt.master %>% filter(records_breached <2000000& !is.na(records_breached)) %>% select(records_breached, cat_name)
ggplot(data = cat_records_breached,aes(x = cat_name, y =records_breached )) + geom_boxplot() + coord_flip()
ggplot(data = cat_records_breached,aes(x = reorder(cat_name,median(records_breached)), y =records_breached)) + geom_boxplot() + coord_flip()
ggplot(data = cat_records_breached,aes(x = reorder(cat_name,med(records_breached)), y =records_breached)) + geom_boxplot() + coord_flip()
ggplot(data = cat_records_breached,aes(x = reorder(cat_name,-records_breached), y =records_breached)) + geom_boxplot() + coord_flip()
ggplot(data = cat_records_breached,aes(x = reorder_within(cat_name,records_breached,median), y =records_breached)) + geom_boxplot() + coord_flip()
reorder_within <- function(x, by, within, fun = mean, sep = "___", ...) {
new_x <- paste(x, within, sep = sep)
stats::reorder(new_x, by, FUN = fun)
}
ggplot(data = cat_records_breached,aes(x = reorder_within(cat_name,records_breached,median), y =records_breached)) + geom_boxplot() + coord_flip()
ggplot(data = cat_records_breached,aes(x = reorder(cat_name,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip()
ggplot(data = cat_records_breached,aes(x = reorder(cat_name,-records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip()
ggplot(data = cat_records_breached,aes(x = reorder(cat_name,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip()
cat_records_breached <- dt.master %>% filter(records_breached <1000000& !is.na(records_breached)) %>% select(records_breached, cat_name)
ggplot(data = cat_records_breached,aes(x = reorder(cat_name,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip()
ggplot(data = cat_records_breached,aes(x = reorder(cat_name,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Category/Industry") + xlab("# Records Breached") + ylab("")
ggplot(data = cat_records_breached,aes(x = reorder(cat_name,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Category/Industry") + ylab("# Records Breached") + xlab("")
ggplot(data = cat_records_breached,aes(x = reorder(cat_name,records_breached,FUN =median), y =records_breached, color = cat_name)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Category/Industry") + ylab("# Records Breached") + xlab("")
ggplot(data = cat_records_breached,aes(x = reorder(cat_name,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Category/Industry") + ylab("# Records Breached") + xlab("")
state_records_breached <-dt.master %>%filter(!is.na(records_breached)) %>%select(state_records_breached, records_breached)
str(dt.master)
state_records_breached <-dt.master %>%filter(!is.na(records_breached)) %>% select(state, records_breached)
ggplot(data = state_records_breached,aes(x = reorder(state,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Category/Industry") + ylab("# Records Breached") + xlab("")
state_records_breached <-dt.master %>%filter(!is.na(records_breached) & records_breached <10000) %>% select(state, records_breached)
ggplot(data = state_records_breached,aes(x = reorder(state,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Category/Industry") + ylab("# Records Breached") + xlab("")
state_records_breached <-dt.master %>%filter(!is.na(records_breached) & records_breached <100000) %>% select(state, records_breached)
ggplot(data = state_records_breached,aes(x = reorder(state,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Category/Industry") + ylab("# Records Breached") + xlab("")
state_records_breached <-dt.master %>%filter(!is.na(records_breached) & records_breached <100000) %>% select(state, records_breached)
str(dt.master)
region_records_breached <-dt.master %>%filter(!is.na(records_breached)) %>% select(region, records_breached)
ggplot(data = region_records_breached,aes(x = reorder(region,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Region") + ylab("# Records Breached") + xlab("")
region_records_breached <-dt.master %>%filter(!is.na(records_breached) & records_breached <1000000) %>% select(region, records_breached)
ggplot(data = region_records_breached,aes(x = reorder(region,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Region") + ylab("# Records Breached") + xlab("")
region_records_breached <-dt.master %>%filter(!is.na(records_breached) & records_breached <1000000 & !is.na(region)) %>% select(region, records_breached)
ggplot(data = region_records_breached,aes(x = reorder(region,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Region") + ylab("# Records Breached") + xlab("")
region_records_breached <-dt.master %>%filter(!is.na(records_breached) & records_breached <1000000 & region!="" %>% select(region, records_breached)
region_records_breached <-dt.master %>%filter(!is.na(records_breached) & records_breached <1000000 & region!="" %>% select(region, records_breached)
region_records_breached <-dt.master %>%filter(!is.na(records_breached) & records_breached <1000000 & region!="") %>% select(region, records_breached)
ggplot(data = region_records_breached,aes(x = reorder(region,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Region") + ylab("# Records Breached") + xlab("")
region_records_breached <-dt.master %>%filter(!is.na(records_breached) & records_breached <100000 & region!="") %>% select(region, records_breached)
ggplot(data = region_records_breached,aes(x = reorder(region,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Region") + ylab("# Records Breached") + xlab("")
dt.master %>% filter(region=="Puerto Rico") %>% arrange(freq = n())
length(dt.master[dt.master$region=="Puerto Rico"])
region_records_breached <-dt.master %>%filter(!is.na(records_breached) & records_breached <50000 & region!="") %>% select(region, records_breached)
ggplot(data = region_records_breached,aes(x = reorder(region,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Region") + ylab("# Records Breached") + xlab("")
dt.master %>% filter(region=="Puerto Rico") %>% mutate(freq = n())
g<-dt.master %>% filter(region=="Puerto Rico") %>% mutate(freq = n())
head(g)
g<-dt.master %>% filter(region=="Puerto Rico") %>% arrange(freq = n(),region)
g<-dt.master %>% filter(region=="Puerto Rico") %>% arrange(freq = n())
region_records_breached <-dt.master %>%filter(!is.na(records_breached) & records_breached <50000 & region!="") %>% select(region, records_breached, state)
ggplot(data = region_records_breached,aes(x = reorder(region,records_breached,FUN =median), y =records_breached, color = state)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Region") + ylab("# Records Breached") + xlab("")
region_records_breached <-dt.master %>%filter(!is.na(records_breached) & records_breached <50000 & region!="" & region!="Puerto Rico") %>% select(region, records_breached, state)
ggplot(data = region_records_breached,aes(x = reorder(region,records_breached,FUN =median), y =records_breached, color = state)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Region") + ylab("# Records Breached") + xlab("")
ggplot(data = region_records_breached,aes(x = reorder(region,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Region") + ylab("# Records Breached") + xlab("")
state_records_breached <-dt.master %>%filter(!is.na(records_breached) & records_breached <100000) %>% select(state, records_breached)
ggplot(data = state_records_breached,aes(x = reorder(state,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across States") + ylab("# Records Breached") + xlab("")
str(dt.master)
#-----
dt.master$total_records<-as.int(dt.master$total_records)
#-----
dt.master$total_records<-as.integer(dt.master$total_records)
#-----
dt.master$total_records<-as.numeric(dt.master$total_records)
str(dt.master)
percentage_breach <- dt.master %>% filter(!is.na(records_breached) & !is.na(total_records)) %>% mutate(percent_breached = records_breached / total_records) %>% select(cat_name,state,region,percentage_breached)
percentage_breach <- dt.master %>% filter(!is.na(records_breached) & !is.na(total_records)) %>% mutate(percent_breached = records_breached / total_records) %>% select(cat_name,state,region,percentage_breached)
percentage_breach <- dt.master %>% filter(!is.na(records_breached) & !is.na(total_records)) %>% mutate(percent_breached= records_breached / total_records)%>% select(cat_name,state,region,percentage_breached)
percentage_breach <- dt.master %>% filter(!is.na(records_breached) & !is.na(total_records)) %>% summarize(percent_breached= records_breached / total_records)%>% select(cat_name,state,region,percentage_breached)
percent_b<- dt.master %>% filter(!is.na(records_breached) & !is.na(total_records)) %>% summarize(percent_breached= records_breached / total_records)%>% select(cat_name,state,region,percentage_breached)
percent_b<- dt.master %>% filter(!is.na(records_breached) & !is.na(total_records)) %>% mutate(percent_breached= records_breached / total_records)%>% select(cat_name,state,region,percentage_breached)
percent_b<- dt.master %>% filter(!is.na(records_breached) & !is.na(total_records)) %>% mutate(percent_breached = records_breached / total_records)%>% select(cat_name,state,region,percent_breached)
percent_breach<- dt.master %>% filter(!is.na(records_breached) & !is.na(total_records)) %>% mutate(percentage_breached = records_breached / total_records)%>% select(cat_name,state,region,percentage_breached)
head(percent_breach)
cat_percent_breach<-ggplot(data = percent_breach,aes(x = reorder(cat_name,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Category/Industry") + ylab("# Records Breached") + xlab("")
cat_percent_breach
cat_percent_breach<-ggplot(data = percent_breach,aes(x = reorder(cat_name,percentage_breached,FUN =median), y =percentage_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Category/Industry") + ylab("# Records Breached") + xlab("")
cat_percent_breach
percent_breach<- dt.master  %>% mutate(percentage_breached = records_breached / total_records)%>% select(cat_name,state,region,percentage_breached)
head(percent_breach)
cat_percent_breach<-ggplot(data = percent_breach,aes(x = reorder(cat_name,percentage_breached,FUN =median), y =percentage_breached)) + geom_boxplot() +
coord_flip() + ggtitle("Distribution of Records Breached Across Category/Industry") + ylab("# Records Breached") + xlab("")
cat_percent_breach
length(is.na(dt.master$total_records))
length(dt.master$total_records)
sum(is.na(dt.master$total_records))
length(dt.master$total_records)
sum(is.na(dt.master$records_breached))
length(dt.master$records_breached)
state_percent_breach<-ggplot(data = percent_breach,aes(x = reorder(state,percentage_breached,FUN =median), y =percentage_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across States") + ylab("# Records Breached") + xlab("")
state_percent_breach<-ggplot(data = percent_breach,aes(x = reorder(state,percentage_breached,FUN =median), y =percentage_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across States") + ylab("# Records Breached") + xlab("")
state_percent_breach<-ggplot(data = percent_breach,aes(x = reorder(state,percentage_breached,FUN =median), y =percentage_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across States") + ylab("# Records Breached") + xlab("")
state_percent_breach
str(dt.master)
color <- dt.master %>% group_by(region, type) %>% summarize(Freq = n()) %>% arrange(desc(Freq))
mosaic_region_type <- dt.master %>% group_by(region, type) %>% summarize(Freq = n()) %>% arrange(desc(Freq))
library(vcd)
counts <- dt.master %>% group_by(region, type) %>% summarize(Freq = n()) %>% arrange(desc(Freq))
mosaic(type~region, counts,
rot_labels = c(0,0, 0,50),
direction = c('v', 'h'))
table(dt.master$type)
str(dt.master)
counts <- dt.master %>% group_by(region, breach_type) %>% summarize(Freq = n()) %>% arrange(desc(Freq))
mosaic(breach_type~region, counts,
rot_labels = c(0,0, 0,50),
direction = c('v', 'h'))
mosaic(breach_type~region, counts,
rot_labels = c(0,0, 0,50),
direction = c('h', 'v'))
mosaic(breach_type~region, counts,
rot_labels = c(0,0, 0,50),
direction = c('v', 'h'))
counts <- dt.master %>% filter(region!= "Argentina" & region!="Puerto Rico") %>% group_by(region, breach_type) %>% summarize(Freq = n()) %>% arrange(desc(Freq))
mosaic(breach_type~region, counts,
rot_labels = c(0,0, 0,50),
direction = c('v', 'h'))
table(counts$breach_type)
counts$region <-factor(counts$region, levels = c('Port', 'PHYS','INSD','DISC','HACK','UNKN','STAT'))
mosaic(breach_type~region, counts,
rot_labels = c(0,0, 0,50),
direction = c('v', 'h'))
counts$region <-factor(counts$region, levels = c('PORT', 'PHYS','INSD','DISC','HACK','UNKN','STAT'))
mosaic(breach_type~region, counts,
rot_labels = c(0,0, 0,50),
direction = c('v', 'h'))
counts <- dt.master %>% filter(region!= "Argentina" & region!="Puerto Rico") %>% group_by(region, breach_type) %>% summarize(Freq = n()) %>% arrange(desc(Freq))
counts$region <-factor(counts$region, levels = c('PORT', 'PHYS','INSD','DISC','HACK','UNKN','STAT'))
mosaic(breach_type~region, counts,
rot_labels = c(0,0, 0,50),
direction = c('v', 'h'))
counts$breach_type <-factor(counts$breach_type, levels = c('PORT', 'PHYS','INSD','DISC','HACK','UNKN','STAT'))
counts$region <- factor(counts$region, levels = c("Southeast","West","Northeast","Midwest","Southwest"))
mosaic(breach_type~region, counts,
rot_labels = c(0,0, 0,50),
direction = c('v', 'h'))
counts <- dt.master %>% filter(region!= "Argentina" & region!="Puerto Rico") %>% group_by(region, breach_type) %>% summarize(Freq = n()) %>% arrange(desc(Freq))
counts$breach_type <-factor(counts$breach_type, levels = c('PORT', 'PHYS','INSD','DISC','HACK','UNKN','STAT'))
#counts$region <- factor(counts$region, levels = c("Southeast","West","Northeast","Midwest","Southwest"))
mosaic(breach_type~region, counts,
rot_labels = c(0,0, 0,50),
direction = c('v', 'h'))
#counts$region <- factor(counts$region, levels = c("Southeast","West","Northeast","Midwest","Southwest"))
mosaic(breach_type~region, counts,
rot_labels = c(0,0, 0,90),
direction = c('v', 'h'))
#counts$region <- factor(counts$region, levels = c("Southeast","West","Northeast","Midwest","Southwest"))
mosaic(breach_type~region, counts,
rot_labels = c(0,0, 0,30),
direction = c('v', 'h'))
#counts$region <- factor(counts$region, levels = c("Southeast","West","Northeast","Midwest","Southwest"))
mosaic(breach_type~region, counts,
rot_labels = c(0,0, 0,10),
direction = c('v', 'h'))
#counts$region <- factor(counts$region, levels = c("Southeast","West","Northeast","Midwest","Southwest"))
mosaic(breach_type~region, counts,
rot_labels = c(0,0, 0,-10),
direction = c('v', 'h'))
#counts$region <- factor(counts$region, levels = c("Southeast","West","Northeast","Midwest","Southwest"))
mosaic(breach_type~region, counts,
rot_labels = c(0,0, 0,30),
direction = c('v', 'h'))
#counts$region <- factor(counts$region, levels = c("Southeast","West","Northeast","Midwest","Southwest"))
mosaic(breach_type~region, counts,
rot_labels = c(0,180, 0,30),
direction = c('v', 'h'))
#counts$region <- factor(counts$region, levels = c("Southeast","West","Northeast","Midwest","Southwest"))
mosaic(breach_type~region, counts,
rot_labels = c(0,0, 90,30),
direction = c('v', 'h'))
#counts$region <- factor(counts$region, levels = c("Southeast","West","Northeast","Midwest","Southwest"))
mosaic(breach_type~region, counts,
rot_labels = c(90,0,0 30),
direction = c('v', 'h'))
#counts$region <- factor(counts$region, levels = c("Southeast","West","Northeast","Midwest","Southwest"))
mosaic(breach_type~region, counts,
rot_labels = c(90,0,0, 30),
direction = c('v', 'h'))
#counts$region <- factor(counts$region, levels = c("Southeast","West","Northeast","Midwest","Southwest"))
mosaic(breach_type~region, counts,
rot_labels = c(80,0,0, 30),
direction = c('v', 'h'))
#counts$region <- factor(counts$region, levels = c("Southeast","West","Northeast","Midwest","Southwest"))
mosaic(breach_type~region, counts,
rot_labels = c(10,0,0, 30),
direction = c('v', 'h'))
#counts$region <- factor(counts$region, levels = c("Southeast","West","Northeast","Midwest","Southwest"))
mosaic(breach_type~region, counts,
rot_labels = c(10,10,0, 30),
direction = c('v', 'h'))
#counts$region <- factor(counts$region, levels = c("Southeast","West","Northeast","Midwest","Southwest"))
mosaic(breach_type~region, counts,
rot_labels = c(10,0,0, 30),
direction = c('v', 'h'))
str(dt.master)
table(dt.master$source_type)
str(dt.master)
table(dt.master$category)
counts2 <- dt.master %>% filter(region!= "Argentina" & region!="Puerto Rico") %>% group_by(category, breach_type) %>% summarize(Freq = n()) %>% arrange(desc(Freq))
counts2
ggplot(data = counts2[1:10,], aes(x=category, y = Freq, fill = breach_type))+ geom_bar()
ggplot(data = counts2[1:10,], aes(x=category, y = Freq, fill = breach_type))+ geom_bar(stat = "identity")
ggplot(data = counts2[1:10,], aes(x=category, y = Freq, fill = breach_type))+ geom_bar(stat = "dodge")
ggplot(data = counts2[1:10,], aes(x=category, y = Freq, fill = breach_type))+ geom_bar(position = "dodge")
ggplot(data = counts2[1:10,], aes(x=category, y = Freq, fill = breach_type))+ geom_bar(stat = "dodge")
ggplot(data = counts2[1:10,], aes(x=category, y = Freq, fill = breach_type))+ geom_bar(stat = "identity")
ggplot(data = counts2[1:10,], aes(x=category, y = Freq))+ geom_bar(stat = "identity")
counts1$breach_type <-factor(counts1$breach_type, levels = c('PORT', 'PHYS','INSD','DISC','HACK','UNKN','STAT'))
mosaic(breach_type~region, counts1,
rot_labels = c(10,0,0, 30),
direction = c('v', 'h'))
counts1 <- dt.master %>% filter(region!= "Argentina" & region!="Puerto Rico") %>% group_by(region, breach_type) %>% summarize(Freq = n()) %>% arrange(desc(Freq))
counts1$breach_type <-factor(counts1$breach_type, levels = c('PORT', 'PHYS','INSD','DISC','HACK','UNKN','STAT'))
mosaic(breach_type~region, counts1,
rot_labels = c(10,0,0, 30),
direction = c('v', 'h'))
cat_percent_breach<-ggplot(data = percent_breach,aes(x = reorder(cat_name,percentage_breached,FUN =median), y =percentage_breached)) + geom_boxplot() +
coord_flip() + ggtitle("Distribution of Records Breached Across Category/Industry") + ylab("# Records Breached") + xlab("")
cat_percent_breach
state_percent_breach<-ggplot(data = percent_breach,aes(x = reorder(state,-percentage_breached), y =percentage_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across States") + ylab("# Records Breached") + xlab("")
state_percent_breach
counts2 <- dt.master %>% filter(region!= "Argentina" & region!="Puerto Rico") %>% group_by(category, breach_type) %>% summarize(Freq = n()) %>% arrange(desc(Freq))
counts2
counts1 <- dt.master %>% filter(region!= "Argentina" & region!="Puerto Rico") %>% group_by(region, breach_type) %>% summarize(Freq = n()) %>% arrange(desc(Freq))
counts1$breach_type <-factor(counts1$breach_type, levels = c('PORT', 'PHYS','INSD','DISC','HACK','UNKN','STAT'))
mosaic(breach_type~region, counts1,
rot_labels = c(10,0,0, 30),
direction = c('v', 'h'))
table(dt.master$category)
counts2 <- dt.master %>% filter(region!= "Argentina" & region!="Puerto Rico") %>% group_by(category, breach_type) %>% summarize(Freq = n()) %>% arrange(desc(Freq))
counts2
counts$breach_type <-factor(counts$breach_type, levels = c('PORT', 'PHYS','INSD','DISC','HACK','UNKN','STAT'))
mosaic(breach_type~category, counts,
rot_labels = c(10,0,0, 30),
direction = c('v', 'h'))
counts2
counts$breach_type <-factor(counts$breach_type, levels = c('PORT', 'PHYS','INSD','DISC','HACK','UNKN','STAT'))
counts2$breach_type <-factor(counts$breach_type, levels = c('PORT', 'PHYS','INSD','DISC','HACK','UNKN','STAT'))
counts2 <- dt.master %>% filter(region!= "Argentina" & region!="Puerto Rico") %>% group_by(category, breach_type) %>% summarize(Freq = n()) %>% arrange(desc(Freq))
counts2
mosaic(breach_type~category, counts2,
rot_labels = c(10,0,0, 30),
direction = c('v', 'h'))
mosaic(breach_type~category, counts2[1:10,],
rot_labels = c(10,0,0, 30),
direction = c('v', 'h'))
mosaic(breach_type~category, counts2[1:20,],
rot_labels = c(10,0,0, 30),
direction = c('v', 'h'))
mosaic(breach_type~category, counts2[1:10,],
rot_labels = c(10,0,0, 30),
direction = c('v', 'h'))
mosaic(breach_type~category, counts2[1:10,],
rot_labels = c(10,0,0, 0),
direction = c('v', 'h'))
mosaic(breach_type~category, counts2[1:10,],
rot_labels = c(0,0,0, 0),
direction = c('v', 'h'))
mosaic(breach_type~category, counts2[1:10,],
rot_labels = c(0,0,0, 0),
direction = c('h', 'v'))
mosaic(breach_type~category, counts2[1:10,],
rot_labels = c(0,0,0, 0),
direction = c('v', 'h'))
counts3 <- counts2 %>% filter(category =="Physician, Hospital")
counts3
physician_cat_breach<-ggplot(data = counts3,aes(x = reorder(region,-records_breached), y =records_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Region") + ylab("# Records Breached") + xlab("")
physician_cat_breach<-ggplot(data = counts3,aes(x = reorder(category,-records_breached), y =category)) + geom_bar() + coord_flip() + ggtitle("Distribution of Records Breached Across Region") + ylab("# Records Breached") + xlab("")
physician_cat_breach
counts3
physician_cat_breach<-ggplot(data = counts3,aes(x = reorder(category,-Freq), y =category)) + geom_bar() + coord_flip() + ggtitle("Distribution of Records Breached Across Region") + ylab("# Records Breached") + xlab("")
physician_cat_breach
physician_cat_breach<-ggplot(data = counts3,aes(x = reorder(category,-Freq), y =category)) + geom_col() + coord_flip() + ggtitle("Distribution of Records Breached Across Region") + ylab("# Records Breached") + xlab("")
physician_cat_breach
physician_cat_breach<-ggplot(data = counts3,aes(x = reorder(category,-Freq), y =Freq)) + geom_col() + coord_flip() + ggtitle("Distribution of Records Breached Across Region") + ylab("# Records Breached") + xlab("")
physician_cat_breach
physician_cat_breach<-ggplot(data = counts3,aes(x = reorder(breach_type,-Freq), y =Freq)) + geom_col() + coord_flip() + ggtitle("Distribution of Records Breached Across Region") + ylab("# Records Breached") + xlab("")
physician_cat_breach
physician_cat_breach<-ggplot(data = counts3,aes(x = reorder(breach_type,-Freq), y =Freq)) + geom_col() + coord_flip() + ggtitle("# Records Breached for each Breach_Type (Physician, Hospital Category)") + ylab("# Records Breached") + xlab("")
physician_cat_breach<-ggplot(data = counts3,aes(x = reorder(breach_type,-Freq), y =Freq)) + geom_col() + coord_flip() + ggtitle("# Records Breached for each Breach_Type (Physician, Hospital Category)") + ylab("# Records Breached") + xlab("")
physician_cat_breach
physician_cat_breach<-ggplot(data = counts3,aes(x = reorder(breach_type,Freq), y =Freq)) + geom_col() + coord_flip() + ggtitle("# Records Breached for each Breach_Type (Physician, Hospital Category)") + ylab("# Records Breached") + xlab("")
physician_cat_breach
counts1 <- dt.master %>% filter(region!= "Argentina" & region!="Puerto Rico") %>% group_by(region, breach_type) %>% summarize(Freq = n()) %>% arrange(desc(Freq))
counts1$breach_type <-factor(counts1$breach_type, levels = c('PORT', 'PHYS','INSD','DISC','HACK','UNKN','STAT'))
mosaic(breach_type~region, counts1,
rot_labels = c(10,0,0, 30),
direction = c('v', 'h'))
counts2 <- dt.master %>% filter(region!= "Argentina" & region!="Puerto Rico") %>% group_by(category, breach_type) %>% summarize(Freq = n()) %>% arrange(desc(Freq))
counts2
ggplot(data = counts2[1:10,], aes(x=category, y = Freq))+ geom_bar(stat = "identity")
counts2$breach_type <-factor(counts$breach_type, levels = c('PORT', 'PHYS','INSD','DISC','HACK','UNKN','STAT'))
mosaic(breach_type~category, counts2[1:10,],
rot_labels = c(0,0,0, 0),
direction = c('v', 'h'))
ggplot(data = counts2[1:10,], aes(x=category, y = Freq))+ geom_bar(stat = "identity")
ggplot(data = counts2[1:10,], aes(x=category, y = Freq))+ geom_bar(stat = "identity")
ggplot(data = counts2[1:10,], aes(x=recorder(category,Freq), y = Freq))+ geom_bar(stat = "identity")
ggplot(data = counts2[1:10,], aes(x=reordercategory,Freq), y = Freq))+ geom_bar(stat = "identity")
ggplot(data = counts2[1:10,], aes(x=reorder(category,Freq), y = Freq))+ geom_bar(stat = "identity")
ggplot(data = counts2[1:10,], aes(x=reorder(category,-Freq), y = Freq))+ geom_bar(stat = "identity")
ggplot(data = counts2[1:10,], aes(x=reorder(category,-Freq), y = Freq))+ geom_bar(stat = "identity") + xlab("Category")
ggplot(data = counts2[1:10,], aes(x=reorder(category,-Freq), y = Freq))+ geom_bar(stat = "identity") + xlab("Category") + ylab("Frequency of Breaches")
ggplot(data = counts2[1:10,], aes(x=reorder(category,-Freq), y = Freq))+ geom_bar(stat = "identity") + xlab("Category") + ylab("Number of Records Breached")
ggplot(data = counts2, aes(x=reorder(category,-Freq), y = Freq))+ geom_bar(stat = "identity") + xlab("Category") + ylab("Number of Records Breached") %>%
counts2$breach_type <-factor(counts$breach_type, levels = c('PORT', 'PHYS','INSD','DISC','HACK','UNKN','STAT'))
ggplot(data = counts2, aes(x=reorder(category,-Freq), y = Freq))+ geom_bar(stat = "identity") + xlab("Category") + ylab("Number of Records Breached")
ggplot(data = counts2, aes(x=reorder(category,-Freq), y = Freq))+ geom_bar(stat = "identity") + xlab("Category") + ylab("Occurences of Breaches")
ggplot(data = counts2, aes(x=reorder(category,-Freq), y = Freq))+ geom_bar(stat = "identity") + xlab("Category") + ylab("Occurences of Breaches") + ggtitle("How Often Breaches Occur to Specific Categories")
counts2$breach_type <-factor(counts$breach_type, levels = c('PORT', 'PHYS','INSD','DISC','HACK','UNKN','STAT'))
mosaic(breach_type~category, counts2[1:10,],
rot_labels = c(0,0,0, 0),
direction = c('v', 'h'))
counts3 <- counts2 %>% filter(category =="Physician, Hospital")
mosaic(breach_type~category, counts2[1:20,],
rot_labels = c(0,0,0, 0),
direction = c('v', 'h'))
mosaic(breach_type~category, counts2[1:20,],
rot_labels = c(0,0,0, 90),
direction = c('v', 'h'))
mosaic(breach_type~category, counts2[1:20,],
rot_labels = c(90,0,0, 90),
direction = c('v', 'h'))
counts1 <- dt.master %>% filter(region!= "Argentina" & region!="Puerto Rico") %>% group_by(region, breach_type) %>% summarize(Freq = n()) %>% arrange(desc(Freq))
counts1$breach_type <-factor(counts1$breach_type, levels = c('PORT', 'PHYS','INSD','DISC','HACK','UNKN','STAT'))
mosaic(breach_type~region, counts1,
rot_labels = c(10,0,0, 30),
direction = c('v', 'h'))
#Category by Breach_Type
table(dt.master$category)
counts2 <- dt.master %>% filter(region!= "Argentina" & region!="Puerto Rico") %>% group_by(category, breach_type) %>% summarize(Freq = n()) %>% arrange(desc(Freq))
counts2
ggplot(data = counts2, aes(x=reorder(category,-Freq), y = Freq))+ geom_bar(stat = "identity") + xlab("Category") + ylab("Occurences of Breaches") + ggtitle("How Often Breaches Occur to Specific Categories")
ggplot(data = counts2[1:10,], aes(x=reorder(category,-Freq), y = Freq))+ geom_bar(stat = "identity") + xlab("Category") + ylab("Occurences of Breaches") + ggtitle("How Often Breaches Occur to Specific Categories")
ggplot(data = counts2[1:11,], aes(x=reorder(category,-Freq), y = Freq))+ geom_bar(stat = "identity") + xlab("Category") + ylab("Occurences of Breaches") + ggtitle("How Often Breaches Occur to Specific Categories")
ggplot(data = counts2[1:12,], aes(x=reorder(category,-Freq), y = Freq))+ geom_bar(stat = "identity") + xlab("Category") + ylab("Occurences of Breaches") + ggtitle("How Often Breaches Occur to Specific Categories")
ggplot(data = counts2[1:15,], aes(x=reorder(category,-Freq), y = Freq))+ geom_bar(stat = "identity") + xlab("Category") + ylab("Occurences of Breaches") + ggtitle("How Often Breaches Occur to Specific Categories")
ggplot(data = counts2[1:16,], aes(x=reorder(category,-Freq), y = Freq))+ geom_bar(stat = "identity") + xlab("Category") + ylab("Occurences of Breaches") + ggtitle("How Often Breaches Occur to Specific Categories")
ggplot(data = counts2[1:16,], aes(x=reorder(category,-Freq), y = Freq))+ geom_bar(stat = "identity") + xlab("Category") + ylab("Occurences of Breaches") + ggtitle("How Often Breaches Occur to Specific Categories") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
counts2
ggplot(data = counts2[1:16,], aes(x=reorder(category,-Freq), y = Freq))+ geom_bar(stat = "identity") + xlab("Category") + ylab("Occurences of Breaches") + ggtitle("How Often Breaches Occur to Specific Categories") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
counts2 <- dt.master %>% filter(region!= "Argentina" & region!="Puerto Rico") %>% group_by(category, breach_type) %>% summarize(Freq = n()) %>% arrange(desc(Freq))
counts2
ggplot(data = counts2[1:16,], aes(x=reorder(category,-Freq), y = Freq))+ geom_bar(stat = "identity") + xlab("Category") + ylab("Occurences of Breaches") + ggtitle("How Often Breaches Occur to Specific Categories") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
counts3 <- counts2 %>% filter(category =="Physician, Hospital")
counts3
physician_cat_breach<-ggplot(data = counts3,aes(x = reorder(breach_type,Freq), y =Freq)) + geom_col() + coord_flip() + ggtitle("# Records Breached for each Breach_Type (Physician, Hospital Category)") + ylab("# Records Breached") + xlab("")
physician_cat_breach
ggplot(data = counts2[1:16,], aes(x=reorder(category,-Freq), y = Freq))+ geom_bar(stat = "identity") + xlab("Category") + ylab("Occurences of Breaches") + ggtitle("How Often Breaches Occur to Specific Categories") + theme(axis.text.x = element_text(angle = 90, hjust = 1))
counts1 <- dt.master %>% filter(region!= "Argentina" & region!="Puerto Rico") %>% group_by(region, breach_type) %>% summarize(Freq = n()) %>% arrange(desc(Freq))
counts1$breach_type <-factor(counts1$breach_type, levels = c('PORT', 'PHYS','INSD','DISC','HACK','UNKN','STAT'))
#
counts3 <- counts2 %>% filter(category =="Physician, Hospital")
physician_cat_breach<-ggplot(data = counts3,aes(x = reorder(breach_type,Freq), y =Freq)) + geom_col() + coord_flip() + ggtitle("# Records Breached for each Breach_Type (Physician, Hospital Category)") + ylab("# Records Breached") + xlab("")
physician_cat_breach
#Region by Breach_Type Mosaic Plot
counts1 <- dt.master %>% filter(region!= "Argentina" & region!="Puerto Rico") %>% group_by(region, breach_type) %>% summarize(Freq = n()) %>% arrange(desc(Freq))
counts1$breach_type <-factor(counts1$breach_type, levels = c('PORT', 'PHYS','INSD','DISC','HACK','UNKN','STAT'))
mosaic(breach_type~region, counts1,
rot_labels = c(10,0,0, 30),
direction = c('v', 'h'))
#Category, Breach_Type Occurence
table(dt.master$category)
counts2 <- dt.master %>% filter(region!= "Argentina" & region!="Puerto Rico") %>% group_by(category, breach_type) %>% summarize(Freq = n()) %>% arrange(desc(Freq))
counts2
ggplot(data = counts2[1:16,], aes(x=reorder(category,-Freq), y = Freq))+
geom_bar(stat = "identity") + xlab("Category") +
ylab("Occurences of Breaches") +
ggtitle("How Often Breaches Occur to Specific Categories") +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
cat_records_breached <- dt.master %>% filter(records_breached <1000000& !is.na(records_breached)) %>% select(records_breached, cat_name)
ggplot(data = cat_records_breached,aes(x = reorder(cat_name,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Category/Industry") + ylab("# Records Breached") + xlab("")
physician_cat_breach<-ggplot(data = counts3,aes(x = reorder(breach_type,Freq), y =Freq)) +
geom_col() + coord_flip() +
ggtitle("# Records Breached for each Breach_Type (Physician, Hospital Category)") +
ylab("Frequency Breach_Type (Does not denote actual # records breached)") + xlab("")
physician_cat_breach
physician_cat_breach<-ggplot(data = counts3,aes(x = reorder(breach_type,Freq), y =Freq)) +
geom_col() + coord_flip() +
ggtitle("# Records Breached for each Breach_Type (Physician, Hospital Category)") +
ylab("Frequency Breach_Type (Not # records breached)") + xlab("")
physician_cat_breach<-ggplot(data = counts3,aes(x = reorder(breach_type,Freq), y =Freq)) +
geom_col() + coord_flip() +
ggtitle("# Records Breached for each Breach_Type (Physician, Hospital Category)") +
ylab("Frequency of Breach Type (Not # records breached)") + xlab("")
#Breach_Type breakdown within Physician, Hospital category
counts3 <- counts2 %>% filter(category =="Physician, Hospital")
physician_cat_breach<-ggplot(data = counts3,aes(x = reorder(breach_type,Freq), y =Freq)) +
geom_col() + coord_flip() +
ggtitle("# Records Breached for each Breach_Type (Physician, Hospital Category)") +
ylab("Frequency of Breach Type (Not # records breached)") + xlab("")
physician_cat_breach
physician_cat_breach<-ggplot(data = counts3,aes(x = reorder(breach_type,Freq), y =Freq)) +
geom_col() + coord_flip() +
ggtitle("Frequency of each Breach_Type (Physician, Hospital Category)") +
ylab("Frequency of Breach Type (Not # records breached)") + xlab("")
physician_cat_breach<-ggplot(data = counts3,aes(x = reorder(breach_type,Freq), y =Freq)) +
geom_col() + coord_flip() +
ggtitle("Frequency of each Breach_Type for Physician, Hospital Category") +
ylab("Frequency of Breach Type (Not # records breached)") + xlab("")
str(dt.master)
table(dt.master$records_breached)
cat_records_breached <- dt.master %>% filter(records_breached <1000000& !is.na(records_breached)) %>% select(records_breached, cat_name)
ggplot(data = cat_records_breached,aes(x = reorder(cat_name,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Category/Industry") + ylab("# Records Breached") + xlab("")
state_records_breached <-dt.master %>%filter(!is.na(records_breached) & records_breached <100000) %>% select(state, records_breached)
ggplot(data = state_records_breached,aes(x = reorder(state,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across States") + ylab("# Records Breached") + xlab("")
region_records_breached <-dt.master %>%filter(!is.na(records_breached) & records_breached <50000 & region!="" & region!="Puerto Rico") %>% select(region, records_breached, state)
ggplot(data = region_records_breached,aes(x = reorder(region,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Region") + ylab("# Records Breached") + xlab("")
cat_records_breached <- dt.master %>% filter(records_breached <1000000& !is.na(records_breached)) %>% select(records_breached, cat_name)
ggplot(data = cat_records_breached,aes(x = reorder(cat_name,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Category/Industry") + ylab("# Records Breached") + xlab("")
########################
#Michelle Exploration###
########################
dt.master <-fread("glue("{parent_dir}/health_care_data/master.csv"")
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
parent_dir <- getwd()
dt.master <-fread("glue("{parent_dir}/health_care_data/master.csv"")
dt.master <-fread("glue("{parent_dir}/health_care_data/master.csv")
dt.master <-fread(glue("{parent_dir}/health_care_data/master.csv")
dt.master <-fread(glue("{parent_dir}/health_care_data/master.csv"))
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
parent_dir <- getwd()
dt.master <-fread(glue("{parent_dir}/health_care_data/master.csv"))
str(dt.master)
table(dt.master$records_breached)
cat_records_breached <- dt.master %>% filter(records_breached <1000000& !is.na(records_breached)) %>% select(records_breached, cat_name)
ggplot(data = cat_records_breached,aes(x = reorder(cat_name,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Category/Industry") + ylab("# Records Breached") + xlab("")
dt.master <-read.csv(glue("{parent_dir}/health_care_data/master.csv"))
```{r setup}
parent_dir <- getwd()
parent_dir
parent_dir
parent_dir <- getwd()
setwd("~/")
parent_dir <- getwd()
parent_dir
setwd("~/")
dt.master <-fread("~/health_care_data/master.csv")
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
parent_dir <- getwd()
dt.master <-fread(glue("{parent_dir}/health_care_data/master.csv"))
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
parent_dir <- getwd()
dt.master <-fread(glue("{parent_dir}/health_care_data/master.csv"))
cat_records_breached <- dt.master %>% filter(records_breached <1000000& !is.na(records_breached)) %>% select(records_breached, cat_name)
ggplot(data = cat_records_breached,aes(x = reorder(cat_name,records_breached,FUN =median), y =records_breached)) + geom_boxplot() + coord_flip() + ggtitle("Distribution of Records Breached Across Category/Industry") + ylab("# Records Breached") + xlab("")
